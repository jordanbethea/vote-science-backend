@import models.dto.SlateLoadDTO
@import models.dto.SlateResultsDTO
@(slateOption: Option[SlateLoadDTO], results: SlateResultsDTO, user: Option[models.User] = None)(implicit request: RequestHeader, messages: Messages)

@title = @{if(slateOption.isDefined){ messages("slate.info.pageTitle", slateOption.get.title)
                    } else {messages("slate.info.pageTitleMissing")}}

@main(title, user){
    @if(slateOption.isDefined) {
        @defining(slateOption.get) { slate =>

            <p>@messages("slate.info.title") @slate.title</p>
            <p>@messages("slate.info.creator") @slate.creatorName()</p>

            <div id="fptpResults">
                <h3>@messages("slate.info.fptpResults")</h3>
                <p>@messages("slate.info.totalBallots") @results.fptpResults.totalBallots</p>
                <p>@messages("slate.info.questions")</p>
                @for(question <- slate.questions) {
                    <h6>@question.text</h6>
                    @for(candidate <- question.candidates) {
                        <div>
                            <span>@candidate.name - @candidate.description</span>
                            <span>@{messages("slate.info.fptpVotesCast")} @{results.fptpResults.getCountForCandidate(question.id, candidate.id)}</span>
                        </div>
                    }
                }
            </div>

          <div id="approvalResults">
              <h3>@messages("slate.info.approvalResults")</h3>
              <p>@messages("slate.info.totalBallots") @results.approvalResults.totalBallots</p>
              <p>@messages("slate.info.questions")</p>
              @for(question <- slate.questions) {
                  <h6>@question.text</h6>
                  @for(candidate <- question.candidates) {
                      <div>
                          <span>@candidate.name - @candidate.description</span>
                          <span>@{messages("slate.info.approvalVotesCast")} @{results.approvalResults.getCountForCandidate(question.id, candidate.id)}</span>
                      </div>
                  }
              }
          </div>

          <div id="rankedResults">
              <h3>@messages("slate.info.rankedResults")</h3>
              <p>@messages("slate.info.questions")</p>
              @for(question <- slate.questions){
                  <h4>@question.text</h4>
                  @for(candidate <- question.candidates) {
                      <h5>@candidate.name</h5>
                      @for(rank <- results.rankedResults.getOrderedRanksForCandidates(question.id.getOrElse(0), candidate.id.getOrElse(0))){
                          <p>@messages("slate.info.totalsPerRank", rank.rankChosen, rank.totalVotes)</p>
                      }
                      <p>@messages("slate.info.bordaScore", results.rankedResults.getBordaScoreForCandidate(question.id.getOrElse(0), candidate.id.getOrElse(0)))</p>
                      <p>@messages("slate.info.dowdallScore", results.rankedResults.getDowdallScoreForCandidate(question.id.getOrElse(0), candidate.id.getOrElse(0)))</p>

                  }
              }
              <h3>@messages("slate.info.IRVResults")</h3>
              @for(question <- slate.questions){
                  <h4>@{question.text}</h4>
                  @for(result <- results.irvResult.singleQuestionIRVResults(question.id.getOrElse(0))){
                      @for(roundResult <- result.roundResults){
                          <p>@messages("slate.info.irvRoundTotal", roundResult.round, roundResult.winner.getOrElse(None))</p>
                          @for(voteTotal <- roundResult.voteTotals){
                              <p>@messages("slate.info.irvCandidateTotal", voteTotal.candidateID, voteTotal.voteCount, voteTotal.percent)</p>
                          }
                          @if(roundResult.winner.isEmpty){ <p>@messages("slate.info.irvEliminated", roundResult.eliminated)</p> }
                      }
                  }
              }
          </div>

          <div id="rangeResults">
              <h3>@messages("slate.info.rangeResults")</h3>
              @for(question <- slate.questions){
                  <h4>@{question.text}</h4>
                  @for(candidate <- question.candidates){
                      <h5>@candidate.name</h5>
                      <p>@messages("slate.info.candidateTotal")
                        <span>@{results.rangeResult.getScore(question.id.getOrElse(0), candidate.id.getOrElse(0))}</span>
                      </p>
                      <h6>@messages("slate.info.rawRangeResults")</h6>
                      @for(result <- results.rangeResult.getRawResults(question.id.getOrElse(0), candidate.id.getOrElse(0))){
                          <p>@messages("slate.info.scoreChosen", result.score, result.votes)</p>
                      }
                  }
              }

          </div>
        }
    } else {
        <p>@messages("slate.info.noSlateFound")</p>
    }
}